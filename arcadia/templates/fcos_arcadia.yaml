variant: fcos
version: 1.4.0
passwd:
  users:
  - name: core
    ssh_authorized_keys:
    - ${ssh_public_key}
systemd:
  units:
  - name: ${app}.service
    enabled: true
    contents: |
      [Unit]
      Description=${app}
      After=network-online.target
      Wants=network-online.target
      [Service]
      Restart=on-failure
      RestartSec=5s
      ExecStartPre=-/bin/podman kill ${app}
      ExecStartPre=-/bin/podman rm ${app}
      ExecStart=/bin/podman run --name ${app} -p 80:80 --add-host=backend:10.10.10.10 --add-host=app2:10.10.10.10 --add-host=app3:10.10.10.10 registry.gitlab.com/arcadia-application/${appdir}/${app}:latest
      [Install]
      WantedBy=multi-user.target
